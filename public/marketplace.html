<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kebapi Marketplace</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', sans-serif; background: #f5f5f5; color: #1a1a1a; }
        .top-bar { background: #f5f5f5; padding: 12px 32px; display: flex; align-items: center; justify-content: space-between; font-size: 13px; color: #666; }
        .welcome { font-weight: 500; }
        .top-nav { display: flex; gap: 24px; }
        .top-nav-item { display: flex; align-items: center; gap: 8px; color: #1a1a1a; text-decoration: none; transition: color 0.2s; }
        .top-nav-item:hover { color: #FF5722; }
        .top-nav-item::before { content: ''; width: 6px; height: 6px; background: #1a1a1a; border-radius: 50%; }
        .top-nav-item.active::before { background: #FF5722; }
        .top-nav-item.active { font-weight: 500; }
        .header { padding: 40px 32px; display: flex; align-items: center; justify-content: space-between; }
        .logo { font-size: 24px; font-weight: 300; letter-spacing: 8px; text-transform: uppercase; }
        .hero { margin: 0 32px 60px; background: #1a1a1a; border-radius: 24px; padding: 80px 60px; color: white; position: relative; }
        .hero-tag { display: inline-flex; align-items: center; gap: 8px; font-size: 12px; margin-bottom: 40px; opacity: 0.7; }
        .hero-tag::before { content: ''; width: 6px; height: 6px; background: white; border-radius: 50%; }
        .hero-subtitle { font-size: 14px; opacity: 0.7; margin-bottom: 40px; }
        .hero-title { font-size: 72px; font-weight: 300; margin-bottom: 24px; line-height: 1.1; }
        .hero-description { font-size: 16px; line-height: 1.8; max-width: 600px; opacity: 0.9; margin-bottom: 40px; }
        .hero-search { max-width: 500px; position: relative; }
        .hero-search input { width: 100%; padding: 16px 20px 16px 50px; border: none; border-radius: 12px; font-size: 15px; background: rgba(255, 255, 255, 0.15); backdrop-filter: blur(10px); color: white; border: 1px solid rgba(255, 255, 255, 0.2); }
        .hero-search input::placeholder { color: rgba(255, 255, 255, 0.6); }
        .hero-search input:focus { outline: none; background: rgba(255, 255, 255, 0.2); border-color: rgba(255, 255, 255, 0.4); }
        .hero-search i { position: absolute; left: 18px; top: 50%; transform: translateY(-50%); color: rgba(255, 255, 255, 0.6); font-size: 16px; }
        .hero-nav { position: absolute; bottom: 40px; right: 60px; width: 48px; height: 48px; background: rgba(255, 255, 255, 0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all 0.3s; }
        .hero-nav:hover { background: rgba(255, 87, 34, 0.2); transform: scale(1.1); }
        .hero-nav i { color: white; font-size: 18px; }
        .container { padding: 0 32px 80px; }
        .section-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 60px; }
        .section-title { font-size: 48px; font-weight: 300; display: flex; align-items: center; gap: 16px; }
        .section-count { width: 32px; height: 32px; background: #1a1a1a; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 14px; font-weight: 500; }
        .section-description { max-width: 500px; font-size: 15px; color: #666; line-height: 1.8; }
        .api-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 24px; }
        .api-card { background: #e8e8e8; border-radius: 20px; padding: 48px; cursor: pointer; transition: all 0.3s; position: relative; }
        .api-card:hover { background: #dcdcdc; transform: translateY(-4px); }
        .api-card-arrow { position: absolute; bottom: 32px; right: 32px; width: 40px; height: 40px; background: #1a1a1a; border-radius: 50%; display: flex; align-items: center; justify-content: center; transition: all 0.3s; }
        .api-card:hover .api-card-arrow { background: #FF5722; }
        .api-card-arrow i { color: white; font-size: 16px; }
        .api-icon { width: 56px; height: 56px; background: #bbb; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 20px; font-weight: 700; color: #1a1a1a; margin-bottom: 32px; }
        .api-badge { display: inline-block; padding: 4px 10px; background: #FF5722; color: white; border-radius: 6px; font-size: 11px; font-weight: 600; text-transform: uppercase; margin-bottom: 16px; }
        .api-title { font-size: 18px; font-weight: 500; margin-bottom: 16px; }
        .api-description { font-size: 14px; color: #666; line-height: 1.7; }
        .stats-box { position: fixed; bottom: 40px; left: 32px; background: white; border-radius: 16px; padding: 24px 32px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1); z-index: 100; }
        .stats-number { font-size: 32px; font-weight: 300; display: flex; align-items: center; gap: 8px; margin-bottom: 4px; }
        .stats-dot { width: 8px; height: 8px; background: #FF5722; border-radius: 50%; }
        .stats-label { font-size: 13px; color: #666; }
        .stats-dots { display: flex; gap: 6px; margin-top: 12px; }
        .stats-dots span { width: 6px; height: 6px; background: #ddd; border-radius: 50%; cursor: pointer; }
        .stats-dots span.active { background: #1a1a1a; }
        .loading { text-align: center; padding: 100px 20px; }
        .spinner { width: 40px; height: 40px; border: 3px solid #e8e8e8; border-top-color: #FF5722; border-radius: 50%; animation: spin 0.8s linear infinite; margin: 0 auto 20px; }
        @keyframes spin { to { transform: rotate(360deg); } }
        .empty-state { text-align: center; padding: 100px 20px; }
        .empty-title { font-size: 32px; font-weight: 300; margin-bottom: 16px; }
        .empty-description { font-size: 16px; color: #666; }
        .hidden { display: none !important; }
    </style>
</head>
<body>
    <div class="top-bar">
        <div class="welcome">Welcome</div>
        <nav class="top-nav">
            <a href="/" class="top-nav-item">Home</a>
            <a href="/marketplace.html" class="top-nav-item active">Marketplace</a>
            <a href="/" class="top-nav-item">APIs</a>
            <a href="/" class="top-nav-item">Docs</a>
        </nav>
        <div style="font-size: 12px; color: #999;">EN</div>
    </div>

    <header class="header">
        <div class="logo">KEBAPI</div>
    </header>

    <section class="hero">
        <div class="hero-tag">Introduction</div>
        <div class="hero-subtitle">We are API & tech</div>
        <h1 class="hero-title">We are Kebapi</h1>
        <p class="hero-description">
            We are a platform for developers and creators who build, share and discover public APIs.
            Our approach is simple, our passion is technology and open source.
        </p>
        <div class="hero-search">
            <i class="fas fa-search"></i>
            <input type="text" id="heroSearch" placeholder="Search APIs..." onkeyup="filterAPIs()">
        </div>
        <div class="hero-nav">
            <i class="fas fa-arrow-right"></i>
        </div>
    </section>

    <div class="container">
        <div class="section-header">
            <h2 class="section-title">
                APIs
                <span class="section-count" id="apiCount">0</span>
            </h2>
            <p class="section-description">
                Browse our collection of public APIs created by developers worldwide.
                Each API is ready to integrate, documented and actively maintained by the community.
            </p>
        </div>

        <div id="loading" class="loading">
            <div class="spinner"></div>
        </div>

        <div id="apiGrid" class="api-grid hidden"></div>

        <div id="emptyState" class="empty-state hidden">
            <h3 class="empty-title">No APIs yet</h3>
            <p class="empty-description">Be the first to publish an API to the marketplace</p>
        </div>
    </div>

    <div class="stats-box">
        <div class="stats-number">
            <span class="stats-dot"></span>
            <span id="statsNumber">0</span>
        </div>
        <div class="stats-label">APIs online</div>
        <div class="stats-dots">
            <span class="active"></span>
            <span></span>
            <span></span>
            <span></span>
        </div>
    </div>

    <script>
        const API_URL = window.location.origin;
        let allAPIs = [];
        let filteredAPIs = [];

        async function loadAPIs() {
            try {
                const response = await fetch(`${API_URL}/api/marketplace`);
                const data = await response.json();

                if (data.success && data.apis && data.apis.length > 0) {
                    allAPIs = data.apis;
                    filteredAPIs = allAPIs;
                    renderAPIs();
                    document.getElementById('apiCount').textContent = allAPIs.length;
                    document.getElementById('statsNumber').textContent = allAPIs.length;
                    document.getElementById('loading').classList.add('hidden');
                } else {
                    document.getElementById('loading').classList.add('hidden');
                    document.getElementById('emptyState').classList.remove('hidden');
                }
            } catch (error) {
                console.error('Error loading APIs:', error);
                document.getElementById('loading').classList.add('hidden');
                document.getElementById('emptyState').classList.remove('hidden');
            }
        }

        function renderAPIs() {
            const grid = document.getElementById('apiGrid');
            
            if (filteredAPIs.length === 0) {
                grid.classList.add('hidden');
                document.getElementById('emptyState').classList.remove('hidden');
                return;
            }

            grid.classList.remove('hidden');
            document.getElementById('emptyState').classList.add('hidden');

            grid.innerHTML = filteredAPIs.map(api => {
                const fullUrl = `${API_URL}/api/${api.project_name}${api.path}`;
                const initials = (api.path.replace('/', '').substring(0, 2) || 'API').toUpperCase();
                const displayAuthor = api.user_email ? api.user_email.split('@')[0] : 'Anonymous';
                
                return `
                    <div class="api-card" onclick="window.open('/api-docs.html?project=${api.project_name}&endpoint=${api.path.replace('/', '')}', '_blank')">
                        <div class="api-badge">${api.project_name}</div>
                        <div class="api-icon">${initials}</div>
                        <h3 class="api-title">${api.path.replace('/', '').charAt(0).toUpperCase() + api.path.replace('/', '').slice(1)} API</h3>
                        <p class="api-description">${api.description}</p>
                        <div style="margin-top: 16px; display: flex; align-items: center; gap: 8px; font-size: 13px; color: #666;">
                            <i class="fas fa-user" style="font-size: 11px;"></i>
                            <span>by <strong>${displayAuthor}</strong></span>
                        </div>
                        <div class="api-card-arrow">
                            <i class="fas fa-arrow-right"></i>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function filterAPIs() {
            const searchTerm = document.getElementById('heroSearch').value.toLowerCase();
            
            if (!searchTerm) {
                filteredAPIs = allAPIs;
            } else {
                filteredAPIs = allAPIs.filter(api => 
                    api.path.toLowerCase().includes(searchTerm) ||
                    api.description.toLowerCase().includes(searchTerm) ||
                    api.project_name.toLowerCase().includes(searchTerm) ||
                    (api.user_email && api.user_email.toLowerCase().includes(searchTerm))
                );
            }
            
            renderAPIs();
        }

        loadAPIs();
    </script>
</body>
</html>